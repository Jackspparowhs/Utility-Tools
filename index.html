<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Utility Tools ‚Äî PirateRuler.com</title>
  <meta name="description" content="Utility Tools by PirateRuler.com ‚Äî notes, stopwatch, date diff, world clock, password, converters and text helpers. Private & fast." />
  <meta name="theme-color" content="#f7fbff" />
  <style>
    /* Adapted from your calculator css ‚Äî colors & layout preserved */
    :root{
      --bg:#f3f7fb; --card:#ffffff; --muted:#6b7480; --text:#0b2130;
      --accent-start:#6b7dff; --accent-end:#0bb3ff;
      --glass: rgba(11,17,28,0.04);
      --radius:14px;
      --shadow-lg: 0 18px 50px rgba(3,12,30,0.18), inset 0 1px 0 rgba(255,255,255,0.6);
      --shadow-sm: 0 8px 24px rgba(3,12,30,0.08);
    }
    html.dark { --bg:#071225; --card:#061028; --muted:#98a7bf; --text:#e9f1ff; --glass: rgba(255,255,255,0.02); --shadow-lg: 0 18px 50px rgba(0,0,0,0.6); --shadow-sm: 0 8px 24px rgba(0,0,0,0.45); }
    *{box-sizing:border-box}
    body{background:linear-gradient(180deg,var(--bg), #e9f6ff); font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; color:var(--text); margin:0; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    a{color:inherit;text-decoration:none}
    .container{max-width:1100px;margin:18px auto;padding:18px;}

    /* Header */
    header.header { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px; border-radius:14px; background:linear-gradient(90deg, rgba(107,125,255,0.07), rgba(11,179,255,0.03)); box-shadow:var(--shadow-sm); }
    .brand {display:flex; align-items:center; gap:12px;}
    .logo {
      width:58px;height:58px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:800;
      background:linear-gradient(135deg,var(--accent-start),var(--accent-end)); color:white; font-size:20px; box-shadow:0 8px 26px rgba(11,123,255,0.15);
      flex-shrink:0;
    }
    .brand-title {line-height:1}
    .brand-title .title-strong {font-size:20px;font-weight:800;margin:0}
    .brand-title .by {font-size:12px;color:var(--muted); margin-top:3px}
    .header-actions {display:flex; gap:10px; align-items:center;}
    .btn {padding:9px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
    .btn.ghost {background:transparent;border:1px solid rgba(0,0,0,0.06); color:var(--text);}
    .btn.theme {background:linear-gradient(90deg,var(--accent-start),var(--accent-end)); color:white}
    .hamb { width:46px;height:46px;border-radius:10px;background:var(--glass);display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid rgba(0,0,0,0.04) }

    /* Sidebar */
    .sidebar {
      position:fixed; top:0; right:0; height:100vh; width:320px; max-width:94vw; transform:translateX(120%); transition:transform .28s cubic-bezier(.2,.9,.3,1); z-index:90;
      background:var(--card); box-shadow: -40px 0 80px rgba(2,8,20,0.25);
      padding:20px; border-left:1px solid rgba(0,0,0,0.04); overflow:auto; border-radius:0 0 0 14px;
    }
    .sidebar.open { transform:translateX(0); }
    .sidebar .close { display:flex; justify-content:flex-end }
    .sidebar h3{margin:0 0 6px 0;font-size:16px}
    .nav-list{margin-top:10px; display:flex; flex-direction:column; gap:12px}
    .nav-list a{display:block;padding:14px;border-radius:10px;background:linear-gradient(180deg, rgba(0,0,0,0.01), rgba(0,0,0,0.02)); color:var(--text); font-weight:600}
    .backup{margin-top:18px;color:var(--muted);font-size:13px}

    /* Hero + pills */
    .hero { margin-top:18px; padding:28px;border-radius:16px;background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96)); box-shadow:var(--shadow-lg); }
    html.dark .hero { background:linear-gradient(180deg, rgba(1,6,12,0.6), rgba(2,8,16,0.6)); }
    .hero .big {font-size:34px;font-weight:900;margin:0;text-align:center}
    .hero .small {text-align:center;color:var(--muted);margin-top:8px; max-width:820px;margin-left:auto;margin-right:auto}
    .pills {display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:18px}
    .pill {padding:10px 16px;border-radius:999px;background:transparent;border:1px solid rgba(11,17,28,0.06); cursor:pointer; color:var(--muted); font-weight:700}
    .pill.active { background:linear-gradient(90deg,var(--accent-start),var(--accent-end)); color:white; box-shadow:0 10px 30px rgba(11,107,255,0.12); transform:translateY(-4px); }

    /* Grid */
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap:18px; margin-top:18px; align-items:start; }
    @media (max-width:980px){ .grid{ grid-template-columns: 1fr } }
    .card { background:var(--card); border-radius:14px; padding:18px; box-shadow:var(--shadow-sm); border:1px solid rgba(0,0,0,0.04); animation:cardIn .42s both}
    @keyframes cardIn { from { transform:translateY(8px); opacity:0 } to { transform:none; opacity:1 } }
    .card h2{margin:0 0 8px 0;font-size:18px}
    .hint{color:var(--muted); font-size:13px; margin-bottom:10px}

    input[type="text"], input[type="number"], input[type="date"], select, textarea {
      width:100%; padding:12px;border-radius:10px;border:1px solid rgba(10,20,40,0.06); font-size:15px; background:transparent; color:var(--text)
    }
    .row {display:flex; gap:10px}
    .primary { background:linear-gradient(90deg,var(--accent-start),var(--accent-end)); color:white; padding:9px 14px; border-radius:10px; border:none; font-weight:800; cursor:pointer }
    .ghost { background:transparent; border:1px solid rgba(0,0,0,0.06); padding:9px 12px;border-radius:10px; cursor:pointer }

    .result { margin-top:12px; font-weight:800; color:#0b8a66 }
    html.dark .result { color:#57f0b6 }

    .key-grid { display:grid; grid-template-columns: repeat(4,1fr); gap:9px; margin-top:12px; }
    .key { padding:14px; border-radius:12px; background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.01)); border:1px solid rgba(0,0,0,0.04); font-weight:700; cursor:pointer; text-align:center }
    .key.op { background:transparent; color:var(--muted) }
    .key.eq { background:linear-gradient(90deg,var(--accent-start),var(--accent-end)); color:white; box-shadow:0 10px 30px rgba(11,107,255,0.12) }

    .features { display:grid; grid-template-columns: repeat(2,1fr); gap:12px; margin-top:18px; }
    @media (max-width:700px){ .features{ grid-template-columns:1fr } }
    .feature { display:flex; gap:14px; align-items:center; padding:14px; border-radius:12px; background:var(--card); box-shadow:var(--shadow-sm); border:1px solid rgba(0,0,0,0.04) }
    .f-icon{width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center; font-weight:800; color:white; background: linear-gradient(135deg,#8ee36b,#2bbf6f); }
    .f-title{font-weight:800}
    .f-desc{color:var(--muted); font-size:13px}

    footer { margin-top:28px; padding:22px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.96)); text-align:center; box-shadow:var(--shadow-lg) }
    .visit { padding:12px 20px; border-radius:999px; display:inline-block; background:linear-gradient(90deg,#ff7aa2 0%, #6b7dff 100%); color:white; font-weight:800; text-decoration:none }

    .muted{color:var(--muted)}
    .spacer{height:8px}
    /* dark overrides for inputs */
    html.dark input, html.dark textarea, html.dark select { background: rgba(255,255,255,0.02); border-color: rgba(255,255,255,0.04); color: var(--text); }
  </style>
</head>
<body>
  <div class="container">

    <!-- Header - matches calculator layout -->
    <header class="header" role="banner" aria-label="Site header">
      <div class="brand">
        <a href="/" aria-label="Home" style="display:flex; align-items:center; gap:12px">
          <div class="logo" aria-hidden="true">PR</div>
          <div class="brand-title">
            <div class="title-strong">Utility Tools</div>
            <div class="by">by PirateRuler.com</div>
          </div>
        </a>
      </div>

      <div class="header-actions" role="navigation" aria-label="Header controls">
        <button id="themeBtn" class="btn theme" title="Toggle theme">Light</button>
        <div class="hamb" id="hambBtn" title="Open menu" aria-haspopup="true" aria-controls="sidebar">‚ò∞</div>
      </div>
    </header>

    <!-- HERO -->
    <section class="hero" aria-labelledby="heroTitle">
      <h1 id="heroTitle" class="big">All-in-one Utility Tools</h1>
      <p class="small">Everyday quick tools people love ‚Äî zero APIs, instant execution. Notes, stopwatch, date difference, world clock, password generator, converters and text helpers ‚Äî private and lightweight.</p>

      <div class="pills" role="tablist" aria-label="Tool tabs">
        <button class="pill active" data-target="notes">Notes</button>
        <button class="pill" data-target="stopwatch">Stopwatch</button>
        <button class="pill" data-target="datediff">Date Diff</button>
        <button class="pill" data-target="worldclock">World Clock</button>
        <button class="pill" data-target="password">Password</button>
        <button class="pill" data-target="clipboard">Clipboard</button>
        <button class="pill" data-target="filesize">File Size</button>
        <button class="pill" data-target="charword">Char/Word</button>
        <button class="pill" data-target="caseconv">Case Conv</button>
        <button class="pill" data-target="textformat">Text Format</button>
      </div>
    </section>

    <!-- MAIN GRID -->
    <main class="grid" role="main">

      <!-- LEFT COLUMN: Tools -->
      <div>

        <!-- Notes (simple textarea) -->
        <section id="notes" class="card" aria-labelledby="notesTitle">
          <h2 id="notesTitle">Notes</h2>
          <div class="hint">Quick private notes ‚Äî saved to localStorage (only in your browser).</div>
          <textarea id="notesArea" rows="6" placeholder="Write notes..."></textarea>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="primary" id="saveNotes">Save</button>
            <button class="ghost" id="clearNotes">Clear</button>
            <button class="ghost" id="exportNotes">Export</button>
          </div>
          <div id="notesMsg" class="muted" style="margin-top:10px"></div>
        </section>

        <!-- Stopwatch -->
        <section id="stopwatch" class="card" hidden aria-labelledby="swTitle">
          <h2 id="swTitle">Stopwatch</h2>
          <div class="hint">Start, stop and reset. Lap support included.</div>
          <div style="font-size:28px;font-weight:800" id="swDisplay">00:00:00.00</div>
          <div style="height:10px"></div>
          <div style="display:flex;gap:8px">
            <button class="primary" id="swStart">Start</button>
            <button class="ghost" id="swStop">Stop</button>
            <button class="ghost" id="swLap">Lap</button>
            <button class="ghost" id="swReset">Reset</button>
          </div>
          <div style="margin-top:12px"><strong class="muted">Laps</strong><div id="swLaps" class="muted" style="margin-top:8px"></div></div>
        </section>

        <!-- Date Diff -->
        <section id="datediff" class="card" hidden aria-labelledby="ddTitle">
          <h2 id="ddTitle">Date difference finder</h2>
          <div class="hint">Calculate days between two dates.</div>
          <div style="display:flex;gap:8px;margin-top:10px">
            <input type="date" id="date1" />
            <input type="date" id="date2" />
          </div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="primary" id="calcDate">Calculate</button>
            <button class="ghost" id="clearDate">Clear</button>
          </div>
          <div id="dateOut" class="result" aria-live="polite"></div>
        </section>

        <!-- World Clock -->
        <section id="worldclock" class="card" hidden aria-labelledby="wcTitle">
          <h2 id="wcTitle">World Clock</h2>
          <div class="hint">Select time zones to view local time (client-side).</div>
          <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
            <select id="tzSelect" style="min-width:180px;">
              <!-- many common zones -->
              <option value="UTC">UTC</option>
              <option value="Europe/London">Europe/London</option>
              <option value="Europe/Paris">Europe/Paris</option>
              <option value="Europe/Berlin">Europe/Berlin</option>
              <option value="Europe/Moscow">Europe/Moscow</option>
              <option value="Africa/Johannesburg">Africa/Johannesburg</option>
              <option value="Asia/Dubai">Asia/Dubai</option>
              <option value="Asia/Kolkata">Asia/Kolkata</option>
              <option value="Asia/Shanghai">Asia/Shanghai</option>
              <option value="Asia/Tokyo">Asia/Tokyo</option>
              <option value="Australia/Sydney">Australia/Sydney</option>
              <option value="Pacific/Auckland">Pacific/Auckland</option>
              <option value="America/New_York">America/New_York</option>
              <option value="America/Chicago">America/Chicago</option>
              <option value="America/Denver">America/Denver</option>
              <option value="America/Los_Angeles">America/Los_Angeles</option>
              <option value="America/Sao_Paulo">America/Sao_Paulo</option>
              <option value="Africa/Cairo">Africa/Cairo</option>
              <option value="Asia/Jerusalem">Asia/Jerusalem</option>
            </select>
            <button class="primary" id="addTz">Add</button>
          </div>
          <div style="margin-top:12px">
            <div id="tzList" style="display:flex;flex-direction:column;gap:10px"></div>
          </div>
        </section>

        <!-- Password (simple generator) -->
        <section id="password" class="card" hidden aria-labelledby="pwTitle">
          <h2 id="pwTitle">Password generator</h2>
          <div class="hint">Generate strong passwords (client-side only).</div>
          <div style="display:flex;gap:8px;margin-top:10px;align-items:center">
            <input id="pwLen" type="number" min="4" max="64" value="16" style="width:110px" />
            <label><input id="pwUpper" type="checkbox" checked /> A-Z</label>
            <label><input id="pwLower" type="checkbox" checked /> a-z</label>
            <label><input id="pwNum" type="checkbox" checked /> 0-9</label>
            <label><input id="pwSym" type="checkbox" checked /> symbol</label>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="primary" id="genPw">Generate</button>
            <button class="ghost" id="copyPw">Copy</button>
          </div>
          <div style="margin-top:10px"><input id="pwOut" type="text" readonly /></div>
        </section>

        <!-- Clipboard -->
        <section id="clipboard" class="card" hidden aria-labelledby="cbTitle">
          <h2 id="cbTitle">Clipboard helpers</h2>
          <div class="hint">Quick copy/paste to browser clipboard.</div>
          <textarea id="cbInput" rows="4" placeholder="Type or paste text..."></textarea>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button class="primary" id="copyBtn">Copy to clipboard</button>
            <button class="ghost" id="pasteBtn">Paste from clipboard</button>
            <button class="ghost" id="clearCb">Clear</button>
          </div>
          <div id="cbMsg" class="muted" style="margin-top:8px"></div>
        </section>

        <!-- File Size converter -->
        <section id="filesize" class="card" hidden aria-labelledby="fsTitle">
          <h2 id="fsTitle">File Size converter</h2>
          <div class="hint">Convert bytes ‚Üî KB ‚Üî MB ‚Üî GB.</div>
          <div style="display:flex;gap:8px;margin-top:10px">
            <input id="fsInput" type="number" placeholder="Bytes" />
            <select id="fsUnit">
              <option value="bytes">Bytes</option>
              <option value="kb">KB</option>
              <option value="mb">MB</option>
              <option value="gb">GB</option>
            </select>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="primary" id="convFs">Convert</button>
            <button class="ghost" id="clearFs">Clear</button>
          </div>
          <div id="fsOut" class="muted" style="margin-top:10px"></div>
        </section>

        <!-- Char & Word counter -->
        <section id="charword" class="card" hidden aria-labelledby="cwTitle">
          <h2 id="cwTitle">Character & Word counter</h2>
          <div class="hint">Paste text to count characters and words.</div>
          <textarea id="cwInput" rows="6" placeholder="Paste text here..."></textarea>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button class="primary" id="countBtn">Count</button>
            <button class="ghost" id="clearCW">Clear</button>
            <button class="ghost" id="copyCW">Copy</button>
          </div>
          <div id="cwResult" class="muted" style="margin-top:8px"></div>
        </section>

        <!-- Case Converter -->
        <section id="caseconv" class="card" hidden aria-labelledby="ccTitle">
          <h2 id="ccTitle">Case Converter</h2>
          <div class="hint">Uppercase, lowercase, Title Case.</div>
          <textarea id="ccInput" rows="4" placeholder="Type or paste..."></textarea>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button class="primary" id="upperBtn">UPPERCASE</button>
            <button class="ghost" id="lowerBtn">lowercase</button>
            <button class="ghost" id="titleBtn">Title Case</button>
            <button class="ghost" id="copyCase">Copy</button>
          </div>
        </section>

        <!-- Text Formatter -->
        <section id="textformat" class="card" hidden aria-labelledby="tfTitle">
          <h2 id="tfTitle">Text Formatter / Indenter</h2>
          <div class="hint">JSON pretty-print, JSON minify, or basic tidy.</div>
          <textarea id="tfInput" rows="6" placeholder='{"hello":"world"}'></textarea>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button class="primary" id="prettyBtn">JSON pretty</button>
            <button class="ghost" id="minifyBtn">JSON minify</button>
            <button class="ghost" id="copyTF">Copy</button>
            <button class="ghost" id="clearTF">Clear</button>
          </div>
          <div id="tfMsg" class="muted" style="margin-top:8px"></div>
        </section>

      </div>

      <!-- RIGHT COLUMN: feature cards & info -->
      <aside>

        <div class="features" aria-hidden="false">
          <div class="feature">
            <div class="f-icon" style="background:linear-gradient(135deg,#6b7dff,#0bb3ff)">‚ö°</div>
            <div>
              <div class="f-title">Lightning fast</div>
              <div class="f-desc">Optimized code, minimal dependencies ‚Äî instant results on mobile & desktop.</div>
            </div>
          </div>

          <div class="feature">
            <div class="f-icon" style="background:linear-gradient(135deg,#8ee36b,#2bbf6f)">üîí</div>
            <div>
              <div class="f-title">Private by design</div>
              <div class="f-desc">No personal data is stored ‚Äî everything runs in your browser by default.</div>
            </div>
          </div>

          <div class="feature">
            <div class="f-icon" style="background:linear-gradient(135deg,#ffb86b,#ff6b7a)">üß∞</div>
            <div>
              <div class="f-title">All tools in one</div>
              <div class="f-desc">Notes, stopwatch, converters, text tools ‚Äî ready to use.</div>
            </div>
          </div>

          <div class="feature">
            <div class="f-icon" style="background:linear-gradient(135deg,#c471ed,#7bffdd)">üåê</div>
            <div>
              <div class="f-title">Backup resources</div>
              <div class="f-desc">If this site is offline, visit PirateRuler.com for backups & resources.</div>
            </div>
          </div>

          <div class="feature">
            <div class="f-icon" style="background:linear-gradient(135deg,#ff7aa2,#6b7dff)">üîß</div>
            <div>
              <div class="f-title">Developer friendly</div>
              <div class="f-desc">Lightweight code you can fork and host ‚Äî transparent and easy to customize.</div>
            </div>
          </div>
        </div>

        <div style="height:18px"></div>

        <div class="card" style="padding:16px">
          <div style="display:flex;gap:12px; align-items:center">
            <div style="width:56px;height:56px;border-radius:12px; background:linear-gradient(135deg,#6b7dff,#0bb3ff); display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900">PR</div>
            <div>
              <div style="font-weight:800">Utility Tools</div>
              <div class="muted" style="font-size:13px">by PirateRuler.com ‚Äî Private ¬∑ Fast</div>
            </div>
          </div>

          <div class="spacer"></div>

          <div style="display:flex;flex-direction:column; gap:10px">
            <a href="https://www.pirateruler.com/post/about.html" target="_blank" rel="noopener noreferrer">About ‚Äî PirateRuler</a>
            <a href="https://www.pirateruler.com/post/privacy.html" target="_blank" rel="noopener noreferrer">Privacy Policy</a>
            <a href="https://www.pirateruler.com/post/contact.html" target="_blank" rel="noopener noreferrer">Contact</a>
            <a href="https://www.pirateruler.com/post/terms.html" target="_blank" rel="noopener noreferrer">Terms & Service</a>
          </div>

          <div class="backup" style="margin-top:14px">
            Backup: <a href="https://pirateruler.com" target="_blank" rel="noopener noreferrer">pirateruler.com</a>
          </div>
        </div>

      </aside>
    </main>

    <!-- Footer -->
    <footer>
      <a class="visit" href="https://pirateruler.com" target="_blank" rel="noopener noreferrer">Visit PirateRuler.com</a>
      <div style="height:12px"></div>
      <small class="muted">¬© <span id="year"></span> Utility Tools by PirateRuler.com ‚Äî All rights reserved. Backup & resources: pirateruler.com</small>
    </footer>
  </div>

  <!-- Sidebar markup -->
  <aside id="sidebar" class="sidebar" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="close"><button class="ghost" id="closeSidebar">Close</button></div>
    <h3>PirateRuler Links</h3>
    <p class="muted">Quick links & backup resources</p>
    <nav class="nav-list" aria-label="PirateRuler quick links">
      <a href="https://www.pirateruler.com/post/about.html" target="_blank" rel="noopener noreferrer">About ‚Äî PirateRuler</a>
      <a href="https://www.pirateruler.com/post/privacy.html" target="_blank" rel="noopener noreferrer">Privacy Policy</a>
      <a href="https://www.pirateruler.com/post/contact.html" target="_blank" rel="noopener noreferrer">Contact</a>
      <a href="https://www.pirateruler.com/post/terms.html" target="_blank" rel="noopener noreferrer">Terms & Service</a>
    </nav>
    <div class="backup">If this site is offline you can visit PirateRuler for backups & resources:<br><a href="https://pirateruler.com" target="_blank" rel="noopener noreferrer">pirateruler.com</a></div>
  </aside>

<script>
  // footer year
  document.getElementById('year').textContent = new Date().getFullYear();

  // THEME: match calculator approach and persist
  const root = document.documentElement;
  const themeBtn = document.getElementById('themeBtn');
  function applyTheme(t){
    if(t === 'dark'){ root.classList.add('dark'); localStorage.setItem('site-theme','dark'); themeBtn.textContent = 'Dark' }
    else { root.classList.remove('dark'); localStorage.setItem('site-theme','light'); themeBtn.textContent = 'Light' }
  }
  const saved = localStorage.getItem('site-theme');
  if(saved) applyTheme(saved); else applyTheme('light');
  themeBtn.addEventListener('click', ()=> applyTheme(root.classList.contains('dark') ? 'light' : 'dark'));

  // SIDEBAR open/close
  const sidebar = document.getElementById('sidebar');
  const hambBtn = document.getElementById('hambBtn');
  const closeSidebar = document.getElementById('closeSidebar');
  function openSidebar(){ sidebar.classList.add('open'); sidebar.setAttribute('aria-hidden','false'); closeSidebar.focus(); }
  function closeSB(){ sidebar.classList.remove('open'); sidebar.setAttribute('aria-hidden','true'); }
  hambBtn.addEventListener('click', openSidebar);
  closeSidebar.addEventListener('click', closeSB);
  document.addEventListener('keydown', e => { if(e.key === 'Escape') closeSB(); });

  // make sidebar width responsive
  function updateSidebarWidth(){ if(window.innerWidth < 420) sidebar.style.width = '94vw'; else sidebar.style.width = '320px'; }
  window.addEventListener('resize', updateSidebarWidth);
  updateSidebarWidth();

  // PILL TABS behaviour (like calculator tabs)
  const pills = Array.from(document.querySelectorAll('.pill'));
  function showTool(id){
    // hide all tool sections
    document.querySelectorAll('main section.card').forEach(s => s.hidden = true);
    const el = document.getElementById(id);
    if(el) el.hidden = false;
    pills.forEach(p => p.classList.toggle('active', p.dataset.target === id));
    // scroll slightly so header doesn't cover
    setTimeout(()=> {
      if(el){ const rect = el.getBoundingClientRect(); window.scrollTo({top: window.scrollY + rect.top - 80, behavior:'smooth'}); }
    }, 80);
  }
  pills.forEach(p => p.addEventListener('click', ()=> showTool(p.dataset.target)));
  // default initial tool
  showTool('notes');

  /* ------------ NOTES ------------- */
  const notesArea = document.getElementById('notesArea');
  const saveNotes = document.getElementById('saveNotes');
  const clearNotes = document.getElementById('clearNotes');
  const exportNotes = document.getElementById('exportNotes');
  const notesMsg = document.getElementById('notesMsg');
  const NOTES_KEY = 'utilitytools-notes-v1';
  // load existing
  notesArea.value = localStorage.getItem(NOTES_KEY) || '';
  saveNotes.addEventListener('click', ()=> {
    localStorage.setItem(NOTES_KEY, notesArea.value);
    notesMsg.textContent = 'Saved locally in your browser';
    setTimeout(()=> notesMsg.textContent='', 2200);
  });
  clearNotes.addEventListener('click', ()=> { notesArea.value=''; localStorage.removeItem(NOTES_KEY); notesMsg.textContent='Cleared'; setTimeout(()=> notesMsg.textContent='',1500); });
  exportNotes.addEventListener('click', ()=> {
    const blob = new Blob([notesArea.value || ''], {type:'text/plain'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='notes.txt'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });

  /* ------------ STOPWATCH ------------- */
  let swTimer=null, swStartAt=0, swElapsed=0; const swDisplay = document.getElementById('swDisplay');
  const swStartBtn = document.getElementById('swStart'), swStopBtn = document.getElementById('swStop'), swLapBtn = document.getElementById('swLap'), swResetBtn = document.getElementById('swReset');
  const swLaps = document.getElementById('swLaps'); let laps=[];
  function formatSw(ms){
    const milli = Math.floor((ms%1000)/10).toString().padStart(2,'0');
    const s = Math.floor(ms/1000)%60; const m = Math.floor(ms/60000)%60; const h = Math.floor(ms/3600000);
    return `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}.${milli}`;
  }
  swStartBtn.addEventListener('click', ()=>{
    if(swTimer) return;
    swStartAt = Date.now() - swElapsed;
    swTimer = setInterval(()=>{ swElapsed = Date.now() - swStartAt; swDisplay.textContent = formatSw(swElapsed); }, 30);
  });
  swStopBtn.addEventListener('click', ()=> { if(!swTimer) return; clearInterval(swTimer); swTimer=null; });
  swResetBtn.addEventListener('click', ()=> { clearInterval(swTimer); swTimer=null; swElapsed=0; swDisplay.textContent='00:00:00.00'; laps=[]; swLaps.innerHTML=''; });
  swLapBtn.addEventListener('click', ()=> { if(!swTimer && swElapsed===0) return; laps.unshift(formatSw(swElapsed)); swLaps.innerHTML = laps.map(l=>`<div>${l}</div>`).join(''); });

  /* ------------ DATE DIFF ------------- */
  const date1 = document.getElementById('date1'), date2 = document.getElementById('date2'), calcDate = document.getElementById('calcDate'), clearDate = document.getElementById('clearDate'), dateOut = document.getElementById('dateOut');
  calcDate.addEventListener('click', ()=>{
    if(!date1.value || !date2.value){ dateOut.textContent = 'Choose both dates'; return; }
    const a=new Date(date1.value), b=new Date(date2.value); if(isNaN(a)||isNaN(b)){ dateOut.textContent='Invalid date(s)'; return; }
    const ms = Math.abs(b-a); const days = Math.floor(ms/(1000*60*60*24));
    dateOut.textContent = days===0? 'Same day': days + ' day' + (days>1?'s':'');
  });
  clearDate.addEventListener('click', ()=> { date1.value=''; date2.value=''; dateOut.textContent=''; });

  /* ------------ WORLD CLOCK ------------- */
  const tzSelect = document.getElementById('tzSelect'), addTz = document.getElementById('addTz'), tzList = document.getElementById('tzList');
  function updateTzDisplay(){
    const now = new Date();
    tzList.querySelectorAll('.tz-item').forEach(node=>{
      const zone = node.dataset.zone;
      try{
        const opts = {timeZone: zone, hour12:false, hour:'2-digit', minute:'2-digit', second:'2-digit'};
        node.querySelector('.tz-time').textContent = new Intl.DateTimeFormat([], opts).format(now);
      }catch(e){
        node.querySelector('.tz-time').textContent = '--:--:--';
      }
    });
  }
  addTz.addEventListener('click', ()=>{
    const zone = tzSelect.value;
    if(!zone) return;
    // avoid duplicates
    if(Array.from(tzList.children).some(c=>c.dataset.zone === zone)) return;
    const el = document.createElement('div'); el.className='tz-item'; el.dataset.zone=zone;
    el.style.display='flex'; el.style.justifyContent='space-between'; el.style.alignItems='center'; el.style.padding='10px'; el.style.borderRadius='10px'; el.style.background = 'linear-gradient(180deg, rgba(0,0,0,0.01), rgba(0,0,0,0.02))';
    el.innerHTML = `<div style="font-weight:800">${zone.replace('_',' ')}</div><div style="text-align:right"><div class="tz-time">--:--:--</div><button style="margin-top:6px" class="ghost removeTz">Remove</button></div>`;
    tzList.prepend(el);
    el.querySelector('.removeTz').addEventListener('click', ()=> el.remove());
    updateTzDisplay();
  });
  setInterval(updateTzDisplay,1000);

  /* ------------ PASSWORD GENERATOR ------------- */
  const genPw = document.getElementById('genPw'), copyPw = document.getElementById('copyPw'), pwOut = document.getElementById('pwOut');
  genPw.addEventListener('click', ()=>{
    const len = parseInt(document.getElementById('pwLen').value) || 16;
    const upper = document.getElementById('pwUpper').checked;
    const lower = document.getElementById('pwLower').checked;
    const num = document.getElementById('pwNum').checked;
    const sym = document.getElementById('pwSym').checked;
    let chars = '';
    if(upper) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    if(lower) chars += 'abcdefghijklmnopqrstuvwxyz';
    if(num) chars += '0123456789';
    if(sym) chars += '!@#$%^&*()-_=+[]{};:,.<>?';
    if(!chars){ pwOut.value = ''; alert('Enable at least one charset'); return; }
    let out = ''; const rnd = crypto && crypto.getRandomValues ? crypto.getRandomValues.bind(crypto) : null;
    if(rnd){
      const data = new Uint32Array(len);
      crypto.getRandomValues(data);
      for(let i=0;i<len;i++) out += chars[data[i] % chars.length];
    } else {
      for(let i=0;i<len;i++) out += chars[Math.floor(Math.random()*chars.length)];
    }
    pwOut.value = out;
  });
  copyPw.addEventListener('click', ()=> { if(!pwOut.value) return; navigator.clipboard.writeText(pwOut.value).then(()=> alert('Copied')) });

  /* ------------ CLIPBOARD ------------- */
  const copyBtn = document.getElementById('copyBtn'), pasteBtn = document.getElementById('pasteBtn'), cbInput = document.getElementById('cbInput'), clearCb = document.getElementById('clearCb'), cbMsg = document.getElementById('cbMsg');
  copyBtn.addEventListener('click', ()=> navigator.clipboard.writeText(cbInput.value || '').then(()=> { cbMsg.textContent='Copied'; setTimeout(()=> cbMsg.textContent='',1200); }).catch(()=> cbMsg.textContent='Failed' ));
  pasteBtn.addEventListener('click', async ()=> { try{ const t = await navigator.clipboard.readText(); cbInput.value = t; cbMsg.textContent='Pasted'; setTimeout(()=> cbMsg.textContent='',1200); }catch(e){ cbMsg.textContent='Paste failed'; } });
  clearCb.addEventListener('click', ()=> { cbInput.value=''; cbMsg.textContent=''; });

  /* ------------ FILE SIZE ------------- */
  const convFs = document.getElementById('convFs'), clearFs = document.getElementById('clearFs'), fsInput = document.getElementById('fsInput'), fsUnit = document.getElementById('fsUnit'), fsOut = document.getElementById('fsOut');
  convFs.addEventListener('click', ()=> {
    const v = parseFloat(fsInput.value);
    const u = fsUnit.value;
    if(isNaN(v)){ fsOut.textContent='Enter a number'; return; }
    let bytes = v;
    if(u === 'kb') bytes = v * 1024;
    if(u === 'mb') bytes = v * 1024 * 1024;
    if(u === 'gb') bytes = v * 1024 * 1024 * 1024;
    fsOut.textContent = `Bytes: ${bytes} ‚Ä¢ KB: ${(bytes/1024).toFixed(3)} ‚Ä¢ MB: ${(bytes/(1024*1024)).toFixed(3)}`;
  });
  clearFs.addEventListener('click', ()=> { fsInput.value=''; fsOut.textContent=''; });

  /* ------------ CHAR & WORD ------------- */
  const cwInput = document.getElementById('cwInput'), countBtn = document.getElementById('countBtn'), clearCW = document.getElementById('clearCW'), cwResult = document.getElementById('cwResult'), copyCW = document.getElementById('copyCW');
  countBtn.addEventListener('click', ()=> {
    const t = cwInput.value || '';
    const chars = t.length;
    const words = t.trim().length ? t.trim().split(/\s+/).length : 0;
    cwResult.textContent = `${words} words ‚Ä¢ ${chars} characters`;
  });
  clearCW.addEventListener('click', ()=> { cwInput.value=''; cwResult.textContent=''; });
  copyCW.addEventListener('click', ()=> navigator.clipboard.writeText(cwInput.value || '').then(()=> alert('Copied')));

  /* ------------ CASE CONVERTER ------------- */
  const ccInput = document.getElementById('ccInput'), upperBtn = document.getElementById('upperBtn'), lowerBtn = document.getElementById('lowerBtn'), titleBtn = document.getElementById('titleBtn'), copyCase = document.getElementById('copyCase');
  upperBtn.addEventListener('click', ()=> ccInput.value = ccInput.value.toUpperCase());
  lowerBtn.addEventListener('click', ()=> ccInput.value = ccInput.value.toLowerCase());
  titleBtn.addEventListener('click', ()=> ccInput.value = ccInput.value.toLowerCase().replace(/\b\w/g, s => s.toUpperCase()));
  copyCase.addEventListener('click', ()=> navigator.clipboard.writeText(ccInput.value || '').then(()=> alert('Copied')));

  /* ------------ TEXT FORMAT ------------- */
  const tfInput = document.getElementById('tfInput'), prettyBtn = document.getElementById('prettyBtn'), minifyBtn = document.getElementById('minifyBtn'), copyTF = document.getElementById('copyTF'), clearTF = document.getElementById('clearTF'), tfMsg = document.getElementById('tfMsg');
  prettyBtn.addEventListener('click', ()=>{
    try{ const v = JSON.parse(tfInput.value); tfInput.value = JSON.stringify(v,null,2); tfMsg.textContent='Formatted'; setTimeout(()=>tfMsg.textContent='',1400); }catch(e){ tfMsg.textContent='Invalid JSON'; setTimeout(()=>tfMsg.textContent='',1800); }
  });
  minifyBtn.addEventListener('click', ()=>{
    try{ const v = JSON.parse(tfInput.value); tfInput.value = JSON.stringify(v); tfMsg.textContent='Minified'; setTimeout(()=>tfMsg.textContent='',1400); }catch(e){ tfMsg.textContent='Invalid JSON'; setTimeout(()=>tfMsg.textContent='',1800); }
  });
  copyTF.addEventListener('click', ()=> navigator.clipboard.writeText(tfInput.value || '').then(()=> { tfMsg.textContent='Copied'; setTimeout(()=>tfMsg.textContent='',1200); }));
  clearTF.addEventListener('click', ()=> { tfInput.value=''; tfMsg.textContent=''; });

  /* Prevent tool overflow: ensure inputs shrink properly on very small screens */
  window.addEventListener('resize', ()=> {
    // placeholder for any runtime adjusting if user reports overflow issues
  });

  /* Accessibility: close sidebar on outside click */
  document.addEventListener('click', function(e){
    if(!sidebar.classList.contains('open')) return;
    const inside = sidebar.contains(e.target) || hambBtn.contains(e.target);
    if(!inside) closeSB();
  });

  // tiny keyboard helpers (prevent pill activation while typing)
  document.addEventListener('keydown', (e)=>{
    const active = document.activeElement;
    if(active && (active.tagName==='INPUT' || active.tagName==='TEXTAREA' || active.tagName==='SELECT')) return;
    // quick hotkeys (N=notes, S=stopwatch, D=date, W=worldclock, T=text)
    if(e.key.toLowerCase() === 'n') showTool('notes');
    if(e.key.toLowerCase() === 's') showTool('stopwatch');
    if(e.key.toLowerCase() === 'd') showTool('datediff');
    if(e.key.toLowerCase() === 'w') showTool('worldclock');
    if(e.key.toLowerCase() === 't') showTool('textformat');
  });
</script>
</body>
</html>
